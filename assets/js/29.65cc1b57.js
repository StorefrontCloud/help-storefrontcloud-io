(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{380:function(e,t,r){"use strict";r.r(t);var n=r(42),s=Object(n.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"nginx-lua-proxy"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#nginx-lua-proxy"}},[e._v("#")]),e._v(" Nginx Lua Proxy")]),e._v(" "),r("p",[e._v("In case when you use "),r("a",{attrs:{href:"https://docs.vuestorefront.io/guide/basics/ssr-cache.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("SSR cache"),r("OutboundLink")],1),e._v(" in your instance you can speed up your instance by using Nginx Lua Proxy.")]),e._v(" "),r("h2",{attrs:{id:"what-is-nginx-lua-proxy"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#what-is-nginx-lua-proxy"}},[e._v("#")]),e._v(" What is Nginx Lua Proxy?")]),e._v(" "),r("p",[e._v("Nginx Lua Proxy is a reverse proxy based on "),r("a",{attrs:{href:"http://openresty.org/en/",target:"_blank",rel:"noopener noreferrer"}},[e._v("OpenResty"),r("OutboundLink")],1),e._v(" serving cached pages directly from Redis without Vue StoreFront, both VSF and VSF API, calls, using "),r("a",{attrs:{href:"https://www.lua.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Lua"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("p",[e._v("Building the Nginx Lua Proxy we based on "),r("a",{attrs:{href:"https://github.com/ClickAndMortar/docker/tree/master/vue-storefront/proxy",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue StoreFront proxy"),r("OutboundLink")],1),e._v(".")]),e._v(" "),r("h2",{attrs:{id:"requirements"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#requirements"}},[e._v("#")]),e._v(" Requirements")]),e._v(" "),r("p",[e._v("Patch of file "),r("code",[e._v("core/scripts/server.[js|ts]")]),e._v(" is required. You should add changes like below:")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("...\n\nconst fs = require('fs')\n\nfunction cacheVersion (req, res) {\n  res.send(fs.readFileSync(resolve('core/build/cache-version.json')))\n}\n\napp.get('/cache-version.json', cacheVersion)\n\n...\n\n")])])]),r("div",{staticClass:"custom-block warning"},[r("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),r("p",[e._v("Nginx Lua Proxy works only with Redis DB0!")]),e._v(" "),r("p",[e._v("If you want to use it please set "),r("code",[e._v("db: 0")]),e._v(" in your instance configuration. More information about Redis configuration you can find in "),r("a",{attrs:{href:"https://docs.vuestorefront.io/guide/basics/configuration.html#redis",target:"_blank",rel:"noopener noreferrer"}},[e._v("Vue Storefront documentation"),r("OutboundLink")],1),e._v(".")])]),e._v(" "),r("div",{staticClass:"custom-block tip"},[r("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),r("p",[e._v("To enable Nginx Lua Proxy on your instance please contact us.")])])])}),[],!1,null,null,null);t.default=s.exports}}]);